<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minesweeper</title>
    <link rel="stylesheet" href="style.css">

    <script type="module">
        // Import the necessary functions from Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";
        import { getDatabase, ref, push, get, query, orderByChild, limitToLast } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-database.js";
    
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBvgcoRklnbChOGEKW2I7bSO6so396gn80",
            authDomain: "minesweeper-game-f50f6.firebaseapp.com",
            databaseURL: "https://minesweeper-game-f50f6-default-rtdb.firebaseio.com",
            projectId: "minesweeper-game-f50f6",
            storageBucket: "minesweeper-game-f50f6.firebasestorage.app",
            messagingSenderId: "933417215645",
            appId: "1:933417215645:web:f2ff3bdfea15ad850a9674"
        };
    
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        console.log("Firebase initialized:", app);
    
        // Load the leaderboard from Firebase
        function loadLeaderboard() {
            const leaderboardRef = ref(database, 'leaderboard');
            const leaderboardQuery = query(leaderboardRef, orderByChild('score'), limitToLast(10));
    
            get(leaderboardQuery).then((snapshot) => {
                const leaderboardList = document.getElementById('scoreList');
                leaderboardList.innerHTML = ''; // Clear existing leaderboard
    
                snapshot.forEach((childSnapshot) => {
                    const scoreData = childSnapshot.val();
                    const listItem = document.createElement('li');
                    listItem.textContent = `${scoreData.name}: ${scoreData.score} seconds`;
                    leaderboardList.appendChild(listItem);
                });
            }).catch((error) => {
                console.error("Error loading leaderboard: ", error);
            });
        }

        // Save the score to Firebase
        function saveScore(playerName, score) {
            const leaderboardRef = ref(database, 'leaderboard');
    
            push(leaderboardRef, {
                name: playerName,
                score: score,
                timestamp: Date.now()
            }).then(() => {
                console.log("Score uploaded successfully!");
                loadLeaderboard(); // Refresh leaderboard after adding score
            }).catch((error) => {
                console.error("Error saving score: ", error);
            });
        }
    </script>
</head>

<body>
    <div id="minesweeper">
        <!-- The game board -->
        <div id="board"></div>
        <div id="info">
            <p>Time: <span id="timer">0</span> seconds</p>
            <button id="reset">Reset</button>
        </div>
    </div>

    <h2>Leaderboard</h2>
    <ul id="scoreList"></ul> <!-- Leaderboard display -->
    
    <script src="script.js"></script>
</body>
</html>
